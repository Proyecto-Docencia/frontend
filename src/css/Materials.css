@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

/* Variables CSS consistentes con USS */
:root {
  --primary-color: var(--color-primary); /* Azul Institucional */
  --primary-hover: var(--color-primary-hover);
  /* Chat panel sizing used to shift page content when open */
  --chat-side-width: 560px;
  --chat-side-padding: 24px;
  /* Estimate of left sidebar width (fallback). Increase to typical expanded sidebar width so
    the layout calculation reserves the right amount of space when chat is open. */
  --left-sidebar-width: 240px;
  --secondary-color: #64748b;
  --accent-color: var(--color-accent);
  --success-color: #16a34a;
  --warning-color: #f59e0b;
  --error-color: #dc2626;
  --border-color: #e2e8f0;
  --border-radius: 12px;
  --border-radius-sm: 8px;
  --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --gradient-primary: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-hover) 100%);
  --gradient-background: linear-gradient(135deg, var(--color-bg-alt) 0%, var(--color-bg-alt-2) 100%);
}

/* Layout principal de Materials */
.materials-container {
  min-height: calc(100vh - 80px);
  /* Hacemos transparente para que se vea la imagen institucional colocada detrás */
  background: transparent;
  padding: 2rem;
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}

.materials-wrapper {
  /* Slightly narrower container gives better central composition */
  max-width: 1200px;
  margin: 0 auto;
  padding-left: 16px;
  padding-right: 16px;
}

/* Header de Materials */
.materials-header {
  background: #fff;
  border-radius: var(--border-radius);
  padding: 2rem;
  margin-bottom: 2rem;
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
}

.materials-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: var(--gradient-primary);
}

.materials-title {
  font-size: 2rem;
  font-weight: 700;
  color: #1e293b;
  margin: 0 0 0.5rem 0;
}

.materials-subtitle {
  color: var(--secondary-color);
  margin: 0;
  font-size: 1rem;
}

.materials-actions {
  display: flex;
  gap: 1rem;
  align-items: center;
  flex-wrap: wrap;
}

/* Botones USS */
.btn-primary {
  background: var(--primary-color);
  color: white;
  border: none;
  border-radius: var(--border-radius-sm);
  padding: 0.75rem 1.5rem;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 0.5rem;
  text-decoration: none;
}

.btn-primary:hover {
  background: var(--primary-hover);
  transform: translateY(-2px);
  box-shadow: var(--shadow-lg);
}

.btn-secondary {
  background: white;
  color: var(--primary-color);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-sm);
  padding: 0.75rem 1.5rem;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.btn-secondary:hover {
  background: #f8fafc;
  border-color: var(--primary-color);
}

/* Grid de materiales */
.materials-grid {
  display: grid;
  /* Use a slightly larger min width so cards keep good proportions and whitespace */
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 2rem;
  margin-bottom: 2.5rem;
  align-items: start;
  justify-content: center; /* center columns when fewer fit */
}

/* Tarjetas de material */
.material-card {
  background: white;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow);
  overflow: hidden;
  transition: var(--transition);
  border: 1px solid var(--border-color);
  position: relative;
  /* keep all cards same height in a row and allow content to push actions down */
  display: flex;
  flex-direction: column;
  height: 100%;
}

.material-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--shadow-xl);
}

.material-thumbnail {
  height: 180px;
  background: var(--gradient-background);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
}

.material-thumbnail::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: var(--gradient-primary);
}

.material-content {
  padding: 1.25rem 1.5rem;
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
}

.material-title {
  font-size: 1.125rem;
  font-weight: 600;
  color: #1e293b;
  margin: 0 0 0.5rem 0;
  line-height: 1.4;
}

.material-description {
  color: var(--secondary-color);
  font-size: 0.92rem;
  line-height: 1.5;
  margin-bottom: 1rem;
  min-height: 3.2rem; /* keep cards visually balanced */
}

.material-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
  font-size: 0.78rem;
  color: var(--secondary-color);
}

.material-badge {
  background: var(--primary-color);
  color: white;
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: 0.625rem;
  font-weight: 500;
  text-transform: uppercase;
}

.material-badge.ai {
  background: var(--success-color);
}

.material-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: auto; /* push actions to the bottom of the card */
}

/* Button tweak for a cleaner compact action area */
.btn-small.primary {
  padding: 0.5rem 0.9rem;
  font-size: 0.9rem;
}

/* Slightly increase spacing for larger viewports */
@media (min-width: 1400px) {
  .materials-wrapper { max-width: 1400px; }
  .materials-grid { gap: 2rem; }
  .material-thumbnail { height: 210px; }
}

@media (max-width: 1024px) {
  .materials-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 640px) {
  .materials-grid { grid-template-columns: 1fr; gap: 1rem; }
  .material-thumbnail { height: 160px; }
  .materials-container { padding: 1rem; }
}

/* When chat is open, reduce the wrapper's available max-width so cards retain proportion
   and stay centered in the remaining viewport area. The calculation prevents the grid
   from collapsing to a single narrow column unnecessarily. */
.with-chat-open .materials-wrapper {
  max-width: min(1200px, calc(100% - var(--chat-side-width) - var(--chat-side-padding) - 48px));
}

/* Contenedor de iconos no clickeables */
.material-icons {
  display: flex;
  gap: 0.75rem;
}

.icon-indicator {
  display: flex;
  align-items: center;
  gap: 0.25rem;
  padding: 0.375rem 0.5rem;
  font-size: 0.75rem;
  border-radius: var(--border-radius-sm);
  background: #f8fafc;
  color: var(--secondary-color);
  border: 1px solid #e2e8f0;
  cursor: default;
  opacity: 0.8;
}

.icon-indicator.audio {
  color: #7c3aed;
  border-color: #ddd6fe;
  background: #faf5ff;
}

.icon-indicator.document {
  color: var(--success-color);
  border-color: #bbf7d0;
  background: #f0fdf4;
}

/* Indicador de Video */
.icon-indicator.video {
  color: #dc2626; /* rojo para diferenciar */
  border-color: #fecaca;
  background: #fef2f2;
}

.btn-small {
  padding: 0.5rem 0.75rem;
  font-size: 0.75rem;
  border-radius: var(--border-radius-sm);
  border: 1px solid var(--border-color);
  background: white;
  color: var(--secondary-color);
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 0.25rem;
  text-decoration: none;
}

.btn-small:hover {
  background: #f8fafc;
  border-color: var(--primary-color);
  color: var(--primary-color);
}

.btn-small.primary {
  background: var(--primary-color);
  color: white;
  border-color: var(--primary-color);
}

.btn-small.primary:hover {
  background: var(--primary-hover);
  border-color: var(--primary-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(30, 58, 138, 0.2);
}

/* Botón volver más pequeño en detalle */
.volver-btn {
  padding: 0.5rem 0.75rem;
  font-size: 0.8rem;
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  right: 1rem;
  width: auto;
  max-width: none;
  display: inline-flex;
  /* Sombra y transición más sutiles */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
  transition: background-color 0.15s ease, border-color 0.15s ease, box-shadow 0.15s ease, transform 0.05s ease;
  /* Asegurar mismo color que el Sidebar */
  background: #1e3a8a;
  border-color: #1e3a8a;
  color: #ffffff;
}

/* Quitar cualquier efecto hover del botón Volver */
.btn-small.primary.volver-btn:hover,
.btn-small.volver-btn:hover,
.volver-btn:hover {
  background: #1e3a8a;
  border-color: #1e3a8a;
  color: #ffffff;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
  transform: translateY(-50%);
  transition: none;
}

/* Efecto de presionado (click) consistente */
.btn-expanded.primary:active {
  transform: scale(0.98);
  box-shadow: 0 2px 8px rgba(30, 58, 138, 0.25);
  transition-duration: 0.05s;
}

.volver-btn:active {
  /* Mantener el centrado vertical y aplicar la misma sensación de "click" */
  transform: translateY(-50%) scale(0.98);
  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.18);
  transition-duration: 0.05s;
}

.btn-small.video {
  color: #dc2626;
  border-color: #fecaca;
}

.btn-small.video:hover {
  background: #fef2f2;
  border-color: #dc2626;
}

.btn-small.pdf {
  color: var(--success-color);
  border-color: #bbf7d0;
}

.btn-small.pdf:hover {
  background: #f0fdf4;
  border-color: var(--success-color);
}

/* Info expandible */
.material-info {
  background: #f8fafc;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-sm);
  padding: 1rem;
  margin-top: 1rem;
}

.material-info-title {
  font-weight: 600;
  color: #1e293b;
  margin-bottom: 0.5rem;
  font-size: 0.875rem;
}

.concept-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.concept-list li {
  padding: 0.25rem 0;
  font-size: 0.75rem;
  color: var(--secondary-color);
  position: relative;
  padding-left: 1rem;
}

.concept-list li::before {
  content: '•';
  color: var(--primary-color);
  position: absolute;
  left: 0;
}

/* Chat de IA */
.chat-fab {
  position: fixed;
  bottom: 2rem;
  right: 2rem;
  width: 60px;
  height: 60px;
  background: var(--primary-color);
  border: none;
  border-radius: 50%;
  color: white;
  cursor: pointer;
  box-shadow: var(--shadow-xl);
  transition: var(--transition);
  z-index: 1000;
  display: flex;
  align-items: center;
  justify-content: center;
}

.chat-fab:hover {
  background: var(--primary-hover);
  transform: scale(1.1);
}

.chat-panel {
  position: fixed;
  top: 0;
  right: 0;
  height: 100vh;
  width: 400px;
  background: white;
  border-left: 1px solid var(--border-color);
  box-shadow: var(--shadow-xl);
  z-index: 1001;
  display: flex;
  flex-direction: column;
}

/* ============== NUEVO CHAT LATERAL (flecha) ============== */
.chat-slide-toggle {
  position: fixed;
  top: 50%;
  right: 0;
  transform: translateY(-50%);
  background: var(--color-primary);
  color: #fff;
  border: none;
  border-radius: 6px 0 0 6px;
  padding: 10px 8px; /* más espacio para icono grande */
  cursor: pointer;
  z-index: 70;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background .2s, box-shadow .2s;
  box-shadow: 0 2px 6px rgba(0,0,0,0.25);
}
.chat-slide-toggle:hover { background: var(--color-primary-hover); }
.chat-slide-toggle:focus-visible { outline: 2px solid var(--color-accent); outline-offset: 2px; }

.chat-side-wrapper {
  position: fixed;
  top: 0;
  right: 0;
  height: 100vh;
  /* Ancho del panel (ajustado nuevamente). Puedes cambiar solo este valor y el padding usará la variable. */
  --chat-side-width: 480px; /* ancho por defecto más contenido y menos intrusivo */
  --chat-side-padding: 16px;
  width: var(--chat-side-width);
  max-width: 90vw;
  transform: translateX(100%);
  transition: transform .35s cubic-bezier(.4,.1,.2,1);
  z-index: 65;
  pointer-events: none;
}
.chat-side-wrapper.open { transform: translateX(0); pointer-events: auto; }

.chat-side-inner {
  height: 100%;
  display: flex;
  flex-direction: column;
  /* Replica aproximada del fondo del Chatbot: claro con suave gradiente */
  background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
  border-left: 1px solid var(--color-border);
}

.chat-side-header {
  padding: 14px 18px 12px 18px;
  border-bottom: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: #ffffffcc;
  backdrop-filter: blur(4px);
}
.chat-side-title { display:flex; align-items:center; gap:8px; }
.chat-side-title h3 { margin:0; font-size: 15px; font-weight:600; color: var(--color-text-strong); }
.chat-side-badge {
  background: linear-gradient(to-br, #2563eb, #4f46e5); /* azul similar Chatbot avatar */
  background: linear-gradient(135deg,#2563eb,#4f46e5);
  color: #fff;
  font-weight: 600;
  font-size: 11px;
  padding: 6px 8px 5px;
  border-radius: 50%;
  min-width: 34px;
  min-height: 34px;
  display: flex;
  align-items: center;
  justify-content: center;
  letter-spacing: .5px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.chat-side-messages {
  flex: 1;
  overflow-y: auto;
  padding: 18px 20px 10px 20px;
  display: flex;
  flex-direction: column;
  gap: 16px;
  scroll-behavior: smooth;
  background: #f1f5f9; /* slate-50 */
}
.chat-side-messages::-webkit-scrollbar { width: 10px; }
.chat-side-messages::-webkit-scrollbar-track { background: transparent; }
.chat-side-messages::-webkit-scrollbar-thumb { background: var(--color-scroll-thumb); border-radius: 6px; }

.cs-msg { display:flex; }
.cs-msg.user { justify-content: flex-end; }
.cs-msg.ai { justify-content: flex-start; }
.cs-bubble {
  max-width: 78%;
  padding: 12px 16px;
  border-radius: 22px;
  font-size: 14px;
  line-height: 1.5;
  position: relative;
  background: #2563eb; /* blue-600 */
  color: #fff;
  box-shadow: 0 2px 4px rgba(0,0,0,0.15);
  animation: fadeIn .25s ease;
}
.cs-msg.ai .cs-bubble {
  background: #ffffff;
  color: #1e293b; /* slate-800 */
  border: 1px solid #e2e8f0; /* slate-200 */
  box-shadow: 0 1px 3px rgba(0,0,0,0.06);
}

@keyframes fadeIn { from {opacity:0; transform: translateY(4px);} to {opacity:1; transform: translateY(0);} }

.chat-side-input-row {
  padding: 16px 18px;
  border-top: 1px solid #e2e8f0;
  display: flex;
  gap: 14px;
  background: #ffffff;
}
.chat-side-input {
  flex: 1;
  border: 1px solid #cbd5e1; /* slate-300 */
  border-radius: 12px;
  padding: 12px 16px;
  font-size: 14px;
  background: #ffffff;
  color: #1e293b;
  transition: border-color .2s, background .2s, box-shadow .2s;
}
.chat-side-input:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59,130,246,0.25); }
.chat-side-send {
  background: linear-gradient(135deg,#2563eb,#4f46e5); /* mismo gradiente que badge AI */
  color: #fff;
  font-weight: 500;
  padding: 0 22px;
  border-radius: 12px;
  font-size: 14px;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background .25s ease, transform .2s;
  box-shadow: 0 4px 10px -2px rgba(37,99,235,.4);
}
.chat-side-send:hover:not(:disabled) { filter: brightness(1.08); transform: translateY(-1px); }
.chat-side-send:active:not(:disabled) { transform: translateY(0); filter: brightness(0.95); }
.chat-side-send:focus-visible { outline:2px solid #2563eb; outline-offset:2px; }
.chat-side-send:disabled { opacity: .6; cursor: default; }

@media (max-width: 900px) {
  .chat-slide-toggle { top: auto; bottom: 20px; transform: none; right: 12px; border-radius: 8px; }
  .chat-side-wrapper { width: 100%; max-width: 100%; }
  .chat-side-inner { border-left: none; }
}

/* When chat is open, shift main content to keep it visible and centered */
.with-chat-open .profile-container,
.with-chat-open .materials-container {
  /* Add right padding equal to the chat width so children reflow and stay visible. We avoid
     applying padding to the centered wrapper itself to prevent double-shrinking. */
  padding-right: calc(var(--chat-side-width) + var(--chat-side-padding));
  transition: padding-right .35s cubic-bezier(.4,.1,.2,1);
}

/* Alternative: smaller screens should let chat overlay content (no shift) */
@media (max-width: 900px) {
  .with-chat-open .profile-container,
  .with-chat-open .materials-wrapper,
  .with-chat-open .materials-container {
    padding-right: 0 !important;
  }
}

/* When chat is open on larger screens, allow the materials wrapper to expand
   to the remaining viewport width (between left sidebar and chat), and align
   the wrapper closer to the left so cards use available whitespace. */
@media (min-width: 901px) {
  /* Keep the wrapper centered but limit its max width so it doesn't collapse when
     the chat reserves right-side space. This avoids a large left offset and lets
     the grid display multiple columns within the available area. */
  .with-chat-open .materials-wrapper {
    margin: 0 auto;
    width: auto;
    max-width: min(1200px, calc(100% - var(--chat-side-width) - 48px));
  }
}

/* Antiguos estilos de chat (FAB) quedan sin uso tras rediseño */

/* (Se eliminó el comportamiento de desplazar el grid cuando el chat está abierto) */

.chat-header {
  padding: 1rem;
  border-bottom: 1px solid var(--border-color);
  background: var(--gradient-primary);
  color: white;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.chat-header h3 {
  margin: 0;
  font-weight: 600;
}

.chat-close {
  background: none;
  border: none;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: var(--transition);
}

.chat-close:hover {
  background: rgba(255, 255, 255, 0.1);
}

.chat-messages {
  flex: 1;
  overflow-y: auto;
  padding: 1rem;
  background: #f8fafc;
}

.chat-message {
  margin-bottom: 1rem;
  display: flex;
}

.chat-message.user {
  justify-content: flex-end;
}

.chat-message-content {
  max-width: 80%;
  padding: 0.75rem 1rem;
  border-radius: var(--border-radius-sm);
  font-size: 0.875rem;
  line-height: 1.4;
}

.chat-message.user .chat-message-content {
  background: var(--primary-color);
  color: white;
}

.chat-message.ai .chat-message-content {
  background: white;
  border: 1px solid var(--border-color);
  color: #1e293b;
}

.chat-input-form {
  padding: 1rem;
  border-top: 1px solid var(--border-color);
  display: flex;
  gap: 0.5rem;
  background: white;
}

.chat-input {
  flex: 1;
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius-sm);
  padding: 0.75rem;
  font-size: 0.875rem;
  outline: none;
  transition: var(--transition);
}

.chat-input:focus {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
}

.chat-send {
  background: var(--primary-color);
  color: white;
  border: none;
  border-radius: var(--border-radius-sm);
  padding: 0.75rem 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
}

.chat-send:hover {
  background: var(--primary-hover);
}

.chat-send:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Modal de video */
.video-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1002;
  padding: 2rem;
}

.video-modal-content {
  background: white;
  border-radius: var(--border-radius);
  padding: 1.5rem;
  max-width: 800px;
  width: 100%;
  position: relative;
}

.video-modal-close {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: var(--secondary-color);
  padding: 0;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: var(--transition);
}

.video-modal-close:hover {
  background: #f1f5f9;
  color: #1e293b;
}

.video-iframe {
  width: 100%;
  height: 400px;
  border: none;
  border-radius: var(--border-radius-sm);
}

/* Sugerencia de IA */
.ai-suggestion {
  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
  border: 1px solid #bae6fd;
  border-radius: var(--border-radius);
  padding: 1.5rem;
  margin-bottom: 2rem;
}

.ai-suggestion-header {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.ai-suggestion-icon {
  color: var(--primary-color);
}

.ai-suggestion-title {
  font-weight: 600;
  color: #1e293b;
  margin: 0;
}

.ai-suggestion-content {
  color: var(--secondary-color);
  line-height: 1.6;
  margin-bottom: 1rem;
}

/* Responsive design */
@media (max-width: 1024px) {
  .materials-grid {
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  }
  
  .chat-panel {
    width: 100%;
    max-width: 400px;
  }
}

@media (max-width: 768px) {
  .materials-container {
    padding: 1rem;
  }
  
  .materials-header {
    padding: 1.5rem;
  }
  
  .materials-title {
    font-size: 1.5rem;
  }
  
  .materials-grid {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .materials-actions {
    flex-direction: column;
    align-items: stretch;
  }
  
  .chat-fab {
    bottom: 1rem;
    right: 1rem;
    width: 50px;
    height: 50px;
  }
}

@media (max-width: 480px) {
  .material-content {
    padding: 1rem;
  }
  
  .material-actions {
    flex-direction: column;
    gap: 0.25rem;
  }
  
  .btn-small {
    justify-content: center;
  }
  
  .video-modal {
    padding: 1rem;
  }
  
  .video-iframe {
    height: 250px;
  }
}

/* Animaciones */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.animate-fade-in-up {
  animation: fadeInUp 0.5s ease-out;
}

.animate-slide-in-right {
  animation: slideInRight 0.3s ease-out;
}

/* Estados de carga */
.loading {
  opacity: 0.6;
  pointer-events: none;
}

.loading::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 20px;
  height: 20px;
  margin: -10px 0 0 -10px;
  border: 2px solid var(--border-color);
  border-top-color: var(--primary-color);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* Contenido expandible de material */
.expanded-material {
  margin-top: 20px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(30, 58, 138, 0.1);
  border: 1px solid #e2e8f0;
  overflow: hidden;
  animation: expand-in 0.3s ease-out;
}

@keyframes expand-in {
  0% {
    opacity: 0;
    transform: translateY(-10px);
    max-height: 0;
  }
  100% {
    opacity: 1;
    transform: translateY(0);
    max-height: 1000px;
  }
}

.expanded-content {
  padding: 0;
}

.expanded-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 25px;
  background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
  color: white;
  border-bottom: 1px solid #e2e8f0;
}

.expanded-header h3 {
  margin: 0;
  font-size: 20px;
  font-weight: 600;
}

.close-expanded {
  background: rgba(255, 255, 255, 0.2);
  border: none;
  border-radius: 8px;
  padding: 8px;
  color: white;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.close-expanded:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: scale(1.05);
}

.expanded-body {
  padding: 25px;
}

.material-info .description {
  font-size: 16px;
  line-height: 1.6;
  color: #1f2937;
  margin-bottom: 20px;
}

.material-meta {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 12px;
  margin-bottom: 20px;
  padding: 20px;
  background: #f8fafc;
  border-radius: 8px;
  border-left: 4px solid var(--primary-color);
}

.meta-item {
  color: var(--secondary-color);
  font-size: 14px;
}

.meta-item strong {
  color: #1f2937;
  font-weight: 600;
}

.concepts {
  margin: 20px 0;
}

.concepts h4 {
  color: var(--primary-color);
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 12px;
}

.concepts ul {
  list-style: none;
  padding: 0;
  margin: 0 0 15px 0;
}

.concepts li {
  background: #f1f5f9;
  padding: 8px 15px;
  margin: 6px 0;
  border-radius: 6px;
  border-left: 3px solid var(--primary-color);
  color: #1f2937;
  font-size: 14px;
}

.concepts p {
  color: var(--secondary-color);
  font-size: 14px;
  margin-top: 15px;
}

.material-actions {
  display: flex;
  gap: 12px;
  margin: 25px 0;
  flex-wrap: wrap;
}

.btn-expanded {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  border: none;
  border-radius: 8px;
  font-weight: 500;
  font-size: 14px;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.2s ease;
}

.btn-expanded.primary {
  background: var(--primary-color);
  color: white;
}

.btn-expanded.primary:hover {
  background: var(--primary-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(30, 58, 138, 0.3);
}

.btn-expanded.secondary {
  background: #f1f5f9;
  color: #1f2937;
  border: 1px solid #cbd5e1;
}

.btn-expanded.secondary:hover {
  background: #e2e8f0;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.pdf-viewer {
  margin-top: 25px;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  border: 1px solid #e2e8f0;
}

.pdf-iframe {
  width: 100%;
  height: 600px;
  border: none;
  display: block;
}

/* Responsive expandible */
@media (max-width: 768px) {
  .expanded-header {
    padding: 15px 20px;
  }
  
  .expanded-header h3 {
    font-size: 18px;
  }
  
  .expanded-body {
    padding: 20px;
  }
  
  .material-meta {
    grid-template-columns: 1fr;
    padding: 15px;
  }
  
  .material-actions {
    flex-direction: column;
  }

/* Final layout overrides to ensure consistent proportions and whitespace */
.materials-wrapper {
  /* keep a pleasant central column that isn't too wide when many columns fit */
  max-width: 1200px;
}

.materials-grid {
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 2rem;
}

.material-card { box-shadow: var(--shadow); }

@media (min-width: 1200px) {
  .materials-grid { grid-template-columns: repeat(3, 1fr); }
}

@media (max-width: 1000px) {
  .materials-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 640px) {
  .materials-grid { grid-template-columns: 1fr; gap: 1rem; }
}
  
  .btn-expanded {
    justify-content: center;
  }
  
  .pdf-iframe {
    height: 400px;
  }
}